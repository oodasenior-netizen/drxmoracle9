# üöÄ Deployment Guide: Exporting from v0 to Your Local IDE

This guide will help you export your app from v0 and set up all integrations in your local development environment.

---

## üìã **Table of Contents**

1. [Quick Start](#quick-start)
2. [Environment Variables Setup](#environment-variables-setup)
3. [Integration Configuration](#integration-configuration)
4. [Database Setup (Supabase)](#database-setup-supabase)
5. [Firebase Authentication Setup](#firebase-authentication-setup)
6. [AI Provider Setup](#ai-provider-setup)
7. [Optional Services](#optional-services)
8. [Running Locally](#running-locally)
9. [Deployment to Vercel](#deployment-to-vercel)
10. [Troubleshooting](#troubleshooting)

---

## üèÉ **Quick Start**

### Download & Install

\`\`\`bash
# Option 1: Using shadcn CLI (Recommended)
npx shadcn@latest add v0 [your-v0-url]

# Option 2: Download ZIP and extract
# Then install dependencies
npm install
# or
pnpm install
# or
yarn install
\`\`\`

---

## üîë **Environment Variables Setup**

Create a `.env.local` file in your project root with the following variables:

\`\`\`bash
# ============================================
# SUPABASE (Database & Storage)
# ============================================
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key-here
SUPABASE_JWT_SECRET=your-jwt-secret-here

# Database Connection Strings (Auto-generated by Supabase)
POSTGRES_URL=postgresql://...
POSTGRES_PRISMA_URL=postgresql://...
POSTGRES_URL_NON_POOLING=postgresql://...
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-db-password
POSTGRES_DATABASE=postgres
POSTGRES_HOST=db.your-project.supabase.co

# ============================================
# FIREBASE (Authentication)
# ============================================
NEXT_PUBLIC_FIREBASE_API_KEY=your-firebase-api-key
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your-project-id
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your-project.appspot.com
NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your-sender-id
NEXT_PUBLIC_FIREBASE_APP_ID=your-app-id

# ============================================
# AI PROVIDERS (Priority: xAI ‚Üí OpenRouter ‚Üí Groq)
# ============================================

# xAI (Primary - for Grok models)
XAI_API_KEY=xai-your-key-here

# OpenRouter (Secondary - for free models & variety)
OPENROUTER_API_KEY=sk-or-v1-your-key-here

# Groq (Tertiary - for fast uncensored models)
GROQ_API_KEY=gsk_your-key-here

# Google Gemini (Loreworld feature only)
GEMINI_API_KEY=AIza-your-key-here

# ============================================
# IMAGE GENERATION
# ============================================
HF_TOKEN=hf_your-huggingface-token

# ============================================
# ADULT CONTENT APIs (OodaEyeXR)
# ============================================
RULE34_API_KEY=your-rule34-api-key
RULE34_USER_ID=your-rule34-user-id

# ============================================
# SITE CONFIGURATION
# ============================================
NEXT_PUBLIC_SITE_URL=http://localhost:3000
NEXT_PUBLIC_DEV_SUPABASE_REDIRECT_URL=http://localhost:3000/auth/callback
\`\`\`

---

## üîå **Integration Configuration**

### **1. Supabase (Required)**

Supabase provides your database and file storage.

#### Steps:

1. **Create a Supabase Account**
   - Go to [https://supabase.com](https://supabase.com)
   - Sign up and create a new project

2. **Get Your Credentials**
   - Go to Project Settings ‚Üí API
   - Copy the following:
     - `Project URL` ‚Üí `NEXT_PUBLIC_SUPABASE_URL`
     - `anon public` key ‚Üí `NEXT_PUBLIC_SUPABASE_ANON_KEY`
     - `service_role` key ‚Üí `SUPABASE_SERVICE_ROLE_KEY`
   - Go to Project Settings ‚Üí Database
     - Copy all connection strings

3. **Run Database Migrations**
   - The app includes SQL scripts in the `/scripts` folder
   - Run them in order in the Supabase SQL Editor:
     1. `001_create_user_profiles.sql`
     2. `002_create_characters_table.sql`
     3. `003_create_lore_table.sql`
     4. `004_create_rpgweave_tables.sql`
     5. `005_create_character_gallery.sql`
     6. `006_fix_character_gallery_user_id.sql`

4. **Enable Row Level Security (RLS)**
   - The SQL scripts include RLS policies
   - Verify they're enabled in the Supabase dashboard

---

### **2. Firebase Authentication (Required)**

Firebase handles user authentication with email/password.

#### Steps:

1. **Create Firebase Project**
   - Go to [https://console.firebase.google.com](https://console.firebase.google.com)
   - Create a new project
   - Add a web app to your project

2. **Get Your Config**
   - Go to Project Settings ‚Üí General
   - Scroll to "Your apps" section
   - Copy the Firebase SDK config values

3. **Enable Email/Password Auth**
   - Go to Authentication ‚Üí Sign-in method
   - Enable "Email/Password"

4. **Configure Authorized Domains**
   - In Authentication settings
   - Add your domain (e.g., `localhost`, `yourdomain.com`)

See `FIREBASE_SETUP.md` for detailed instructions.

---

### **3. AI Providers (Choose at least one)**

The app uses a priority system: **xAI ‚Üí OpenRouter ‚Üí Groq**

#### **xAI (Recommended - Primary)**

Best for: Grok models with advanced reasoning

1. Visit [https://x.ai](https://x.ai)
2. Create an account and get your API key
3. Add to `.env.local` as `XAI_API_KEY`

**Available Models:**
- `grok-4.1-fast-reasoning` (Default)
- `grok-4.1-fast-non-reasoning`
- `grok-2-1212`
- `grok-beta`

---

#### **OpenRouter (Secondary)**

Best for: Access to 100+ models, many free

1. Visit [https://openrouter.ai](https://openrouter.ai)
2. Sign up and go to Keys section
3. Create an API key
4. Add to `.env.local` as `OPENROUTER_API_KEY`

**Free Models Available:**
- Google Gemini 2.0 Flash
- Mistral Devstral 2
- DeepSeek R1
- Meta Llama 4 Scout/Maverick
- And many more

---

#### **Groq (Tertiary)**

Best for: Ultra-fast inference

1. Visit [https://console.groq.com](https://console.groq.com)
2. Create account and get API key
3. Add to `.env.local` as `GROQ_API_KEY`

---

#### **Google Gemini (Optional - Loreworld only)**

Only needed for the Loreworld feature.

1. Visit [https://makersuite.google.com/app/apikey](https://makersuite.google.com/app/apikey)
2. Create an API key
3. Add to `.env.local` as `GEMINI_API_KEY`

---

### **4. Hugging Face (Optional - Image Generation)**

For AI image generation features.

1. Visit [https://huggingface.co](https://huggingface.co)
2. Sign up and go to Settings ‚Üí Access Tokens
3. Create a token
4. Add to `.env.local` as `HF_TOKEN`

---

### **5. Rule34 API (Optional - OodaEyeXR only)**

For adult content search features.

1. Visit [https://rule34.xxx](https://rule34.xxx)
2. Create an account
3. Go to Account ‚Üí Options ‚Üí API
4. Get your API key and User ID
5. Add to `.env.local`:
   - `RULE34_API_KEY`
   - `RULE34_USER_ID`

---

## üóÑÔ∏è **Database Setup (Supabase)**

### Schema Overview

The app uses the following tables:

- **`user_profiles`** - User account information
- **`characters`** - Character data and definitions
- **`lore_entries`** - World-building lore knowledge base
- **`character_gallery`** - Saved images per character
- **`rpgweave_worlds`** - RPG campaign worlds
- **`rpgweave_sessions`** - Active game sessions
- **`rpgweave_messages`** - Chat messages in campaigns

### Running Migrations

Execute the SQL scripts in the Supabase SQL Editor in order:

\`\`\`sql
-- 1. User profiles
-- Run scripts/001_create_user_profiles.sql

-- 2. Characters
-- Run scripts/002_create_characters_table.sql

-- 3. Lore
-- Run scripts/003_create_lore_table.sql

-- 4. RPGWeave
-- Run scripts/004_create_rpgweave_tables.sql

-- 5. Gallery
-- Run scripts/005_create_character_gallery.sql

-- 6. Gallery fix (Firebase UID support)
-- Run scripts/006_fix_character_gallery_user_id.sql
\`\`\`

---

## üî• **Firebase Authentication Setup**

### Authentication Flow

1. Users sign up with email/password
2. Firebase creates the auth user
3. App stores additional data in Supabase `user_profiles` table
4. User ID is stored in localStorage for offline access

### Important Notes

- Firebase UIDs are strings (not UUIDs)
- Database `user_id` columns use TEXT type to support Firebase
- See `FIREBASE_SETUP.md` for detailed troubleshooting

---

## ü§ñ **AI Provider Setup**

### How It Works

The app uses a **fallback priority system**:

1. **Check for xAI key** ‚Üí Use Grok models
2. **If no xAI** ‚Üí Check OpenRouter ‚Üí Use free models
3. **If no OpenRouter** ‚Üí Check Groq ‚Üí Use fast models
4. **If none** ‚Üí Show error and request API key

### Configuring in App

Users can add API keys in two ways:

1. **Settings Page** (`/settings`)
   - Visual UI to add/edit API keys
   - Keys stored in localStorage
   - Encrypted for security

2. **Environment Variables** (Fallback)
   - If user doesn't provide key in UI
   - App uses keys from `.env.local`

### Model Selection

Available in Settings ‚Üí Model Configuration:

- Default model: `grok-4.1-fast-reasoning`
- Temperature: 0.8 (creativity)
- Max tokens: 2000 (response length)

---

## üé® **Branding & Assets**

### Logo Location

The app logo is located at:
\`\`\`
/public/branding/logo.jpg
\`\`\`

### Using the Logo

\`\`\`tsx
import Image from 'next/image'

<Image
  src="/branding/logo.jpg"
  alt="App Logo"
  width={200}
  height={200}
/>
\`\`\`

---

## üèÉ‚Äç‚ôÇÔ∏è **Running Locally**

\`\`\`bash
# Install dependencies
npm install

# Run development server
npm run dev

# Build for production
npm run build

# Start production server
npm start
\`\`\`

Visit [http://localhost:3000](http://localhost:3000)

---

## ‚òÅÔ∏è **Deployment to Vercel**

### Option 1: Using Vercel CLI

\`\`\`bash
# Install Vercel CLI
npm i -g vercel

# Login
vercel login

# Deploy
vercel
\`\`\`

### Option 2: Using GitHub

1. Push your code to GitHub
2. Import project in Vercel dashboard
3. Add all environment variables in Vercel project settings
4. Deploy automatically on every push

### Environment Variables in Vercel

Add all variables from `.env.local` to:
**Vercel Dashboard ‚Üí Your Project ‚Üí Settings ‚Üí Environment Variables**

Make sure to:
- Add variables for **all environments** (Production, Preview, Development)
- Prefix client-side variables with `NEXT_PUBLIC_`

---

## üêõ **Troubleshooting**

### Supabase Connection Issues

**Problem:** "Failed to connect to database"

**Solution:**
- Verify `NEXT_PUBLIC_SUPABASE_URL` is correct
- Check `NEXT_PUBLIC_SUPABASE_ANON_KEY` is valid
- Ensure RLS policies are configured
- Check if you're using the correct Supabase project

---

### Firebase Auth Issues

**Problem:** "Firebase auth/configuration-not-found"

**Solution:**
- Verify all `NEXT_PUBLIC_FIREBASE_*` variables are set
- Check Firebase console for correct config
- Ensure Email/Password auth is enabled
- See `FIREBASE_SETUP.md` for detailed steps

---

### AI Model Not Working

**Problem:** "No API key provided"

**Solution:**
1. Add API key in `/settings` page, OR
2. Add to `.env.local` as environment variable
3. Restart dev server after adding env variables
4. Check API key format (xAI: `xai-...`, OpenRouter: `sk-or-v1-...`)

---

### OodaEyeXR Not Loading

**Problem:** "Rule34 API returns 0 results"

**Solution:**
- Add `RULE34_API_KEY` and `RULE34_USER_ID` to `.env.local`
- Get API credentials from Rule34.xxx account settings
- Note: Realbooru API is currently offline (use Rule34 instead)

---

### Build Errors

**Problem:** TypeScript or ESLint errors

**Solution:**
\`\`\`bash
# Clear cache
rm -rf .next node_modules
npm install

# Type check
npm run type-check

# Lint
npm run lint
\`\`\`

---

## üìö **Additional Documentation**

- `FIREBASE_SETUP.md` - Detailed Firebase configuration
- `/scripts/*.sql` - Database schema and migrations
- `/lib/storage.ts` - Data storage architecture
- `/lib/ai-providers.ts` - AI provider configuration

---

## üÜò **Support**

If you encounter issues:

1. Check this documentation
2. Review error logs in browser console
3. Verify all environment variables are set correctly
4. Check that all SQL migrations have been run
5. Ensure third-party services (Firebase, Supabase) are properly configured

---

## ‚úÖ **Checklist: Before Going Live**

- [ ] All environment variables added to Vercel
- [ ] Supabase database migrations run
- [ ] Firebase authentication enabled
- [ ] At least one AI provider API key configured
- [ ] Logo/branding assets uploaded
- [ ] RLS policies enabled on Supabase tables
- [ ] Custom domain configured (optional)
- [ ] SSL certificate active
- [ ] Test all major features (auth, chat, image gen)

---

**Good luck with your deployment! üöÄ**
